<UserControl x:Class="MyGarden2.UserControls.Collection"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
             xmlns:local="clr-namespace:MyGarden2.UserControls"
             mc:Ignorable="d" 
             xmlns:materialDesign="http://materialdesigninxaml.net/winfx/xaml/themes"
             d:DesignHeight="667" d:DesignWidth="873">
    <Grid>
        <Grid Width ="250" HorizontalAlignment="Left" Background="#FF8ED911" Opacity="0.8">
            <StackPanel Orientation="Horizontal" VerticalAlignment="Top" Height="40">
                <TextBlock HorizontalAlignment="Left" Text="Поиск:" FontFamily="Arial" FontSize="24"/>
                <TextBox Name="searchBox" Width="150" Margin="5" HorizontalAlignment="Right" FontFamily="Arial" FontSize="16" TextChanged="searchBox_TextChanged"/>
            </StackPanel>
            <ListView Name="plantsListView" ItemsSource="{Binding ChosenPlants}" Margin="0 40 0 0">
                <ListView.ItemContainerStyle>
                    <Style TargetType="ListViewItem">
                        <Setter Property="AllowDrop" Value="True"/>
                        <EventSetter Event="PreviewMouseMove" Handler="PlantListViewItem_PreviewMouseMove"/>
                    </Style>
                </ListView.ItemContainerStyle>
                <ListView.ItemTemplate>
                    <DataTemplate>
                        <Border BorderThickness="1" BorderBrush="Black" CornerRadius="3" Padding="10">
                            <Grid Width="220">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="64"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>

                                <Image Source="{Binding ImagePath}" 
                               Width="64" 
                               Height="64" 
                               Stretch="Uniform"
                               Grid.Column="0"/>

                                <StackPanel Grid.Column="1" Margin="10,0,0,0">
                                    <TextBlock Text="{Binding Name}" 
                                      FontSize="16" 
                                      FontWeight="Bold"
                                      Margin="0,0,0,5"/>

                                    <UniformGrid Columns="2" Margin="0,0,0,5">
                                        <TextBlock Text="{Binding Length, StringFormat='Длина: {0} см'}" 
                                          FontSize="10"/>
                                        <TextBlock Text="{Binding Width, StringFormat='Ширина: {0} см'}" 
                                          FontSize="10"/>
                                    </UniformGrid>

                                    <TextBlock Text="{Binding IsGreenHouseRecText}" 
                                      FontSize="10"/>
                                    <TextBlock Text="Рекомендовано к посадке" FontSize="10"/>
                                    <TextBlock Text="{Binding DateSowingRecBegin, StringFormat='с {0:dd.MM.yyyy}'}" FontSize="10"/>
                                    <TextBlock Text="{Binding DateSowingRecEnd, StringFormat='по {0:dd.MM.yyyy}'}" FontSize="10"/>
                                </StackPanel>
                            </Grid>
                        </Border>
                    </DataTemplate>
                </ListView.ItemTemplate>
                <ListView.ContextMenu>
                    <ContextMenu Background="#FF8ED911" Opacity="0.8">
                        <MenuItem x:Name="DeletePlant" Header="Удалить" Click="DeletePlant_Click"/>
                    </ContextMenu>
                </ListView.ContextMenu>
            </ListView>
        </Grid>
        <Grid Margin="250 0 0 0">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="*"/>
            </Grid.RowDefinitions>
            <Button x:Name="ExportReportButton" HorizontalAlignment="Center" Grid.Row="0" Margin="10" Click="ExportReportButton_Click" Background="#FF8ED911" Opacity="0.8">
                <StackPanel Orientation="Horizontal">
                    <materialDesign:PackIcon Kind="FileExport" Width="20" Height="20" Margin="0 0 4 0"/>
                    <TextBlock Text="Выгрузить отчёт" 
                   VerticalAlignment="Center"
                   FontWeight="Medium"/>
                </StackPanel>
            </Button>
        </Grid>
        <Grid Margin="250 67 0 0">
            <ListView Name="gardenBedsListView" ItemsSource="{Binding UsedGardenBeds}" Grid.Row="1">
                <ListView.ItemContainerStyle>
                    <Style TargetType="ListViewItem">
                        <Setter Property="Margin" Value="10"/>
                        <Setter Property="Padding" Value="0"/>
                        <Setter Property="BorderThickness" Value="0"/>
                        <Setter Property="Background" Value="Transparent"/>
                        <Setter Property="AllowDrop" Value="True"/>
                        <EventSetter Event="Drop" Handler="GardenBedListViewItem_Drop"/>
                        <EventSetter Event="DragOver" Handler="GardenBedListViewItem_DragOver"/>
                    </Style>
                </ListView.ItemContainerStyle>
                <ListView.ItemTemplate>
                    <DataTemplate>
                        <local:ListItemGardenBed Rows="{Binding LengthCells}"
                             Columns="{Binding WidthCells}"
                             IsGreenHouse="{Binding IsGreenHouse}"
                             CellSize="{Binding CellSize}" />
                    </DataTemplate>
                </ListView.ItemTemplate>
                <ListView.ContextMenu>
                    <ContextMenu Background="#FF8ED911" Opacity="0.8">
                        <MenuItem x:Name="DeleteGardenBed" Header="Удалить" Click="DeleteGardenBed_Click"/>
                    </ContextMenu>
                </ListView.ContextMenu>
            </ListView>
        </Grid>
    </Grid>
</UserControl>